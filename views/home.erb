<% start_time = Time.new %>
<% properties = 
	{"atomic_num"=>nil,
	"symbol"=>nil,
	"name"=>nil,
	"e_config" => {"base" => false, "space_terms" => true, "term_spans"=>false}} %>

<!-- Main groups table -->
<% period_header = 0 # labels for periods %>
<table class="home">
	<tr>
		<th class="col1" id="main_col1">Group</th>
		<% @main_groups.each do |group_header| %>
			<th class="home_element">
				<% # if group_header == 1 %> Group <% # end %>
				<%= erb :'partials/group_link_generator', :locals=> {:linear_group => group_header} %>
			</th>
		<% end %>  
	</tr>
<% @ebyp.each do |period| %>
	<% period_header += 1 #increment the period number in preparation for next period %>
	<% lastGroup = 0 %>
	<tr>
		<th class="period_header">
			<% if period_header == 1 %> Period<br> <% end %>
			<%= erb :'partials/link_generator', :locals=> {:link => Hash["type" => 'period','number'=>period_header]} %>			
		</th>
		<% period.each do |element| %>
			<% next if not @main_groups.include? element.group # skip non-main group (e.g., f-block) elements %>
			<% blanks = element.group - lastGroup - 1 %>
			<% while blanks > 0 %>
				<td></td>
				<% blanks -= 1 %>
			<% end %>
			<td class="inPTable">
				<%= erb :'partials/pt_element', :locals=> {:element => element, :markers => true, :properties => properties, :ec_class => "narrow"} %>
				<% if element.group != @main_pauses_group %>
					<% lastGroup = element.group #record the group number of this element %>
				<% else %>
					<% lastGroup = @main_resumes_group-1 #if this is traditional group 2, set lastGroup so won't be blanks between this element and next element (traditional group 3) %>
				<% end %>
			</td>
		<% end %>
 	 </tr>
<% end %> 
</table>

<!-- f groups table -->
<% period_header = 0 # labels for periods %>
<table class="home" id="f_block">
	<tr>
		<th class="col1" id="f_col1"><!--Group--></th>
		<th class="spacer"></th>
		<th class="spacer"></th>
		<% @f_groups.each do |group_header| %>
			<th class="home_element">
				<%= erb :'partials/group_link_generator', :locals=> {:linear_group => group_header} %>
			</th>
		<% end %>
	</tr>
	
	<% @ebyp.each do |period| %>
		<% period_header += 1 #increment the period number in preparation for next period %>
		<% lastGroup = 0 %>
		<%# if Element.all(:period => period_header, :group => @main_pauses_group+1).size > 0 # if there are f group elements in this period, plot them; if not, skip period %>
		<% if Element.where(:period => period_header, :group => @main_pauses_group+1).size > 0 # if there are f group elements in this period, plot them; if not, skip period %>
			<tr>
				<th class="period_header">
					<%= erb :'partials/link_generator', :locals=> {:link => Hash["type" => 'period','number'=>period_header]} %>			
				</th>
				<td class="spacer"></td>
				<td class="spacer marker">
					<% if period_header == 6 %><%=@star%><% end %>
					<% if period_header == 7 %><%=@star%><%=@star%><% end %>
				</td>
				<% period.each do |element| %>
					<% next if not @f_groups.include? element.group # if element group isn't an f group, skip element %>
					<td class="inPTable">
						<%= erb :'partials/pt_element', :locals=> {:element => element, :ec_class => "narrow", :properties => properties} %>
						<% lastGroup = element.group %>
					</td>
				<% end %>
				<td class="spacer"></td>
				<td class="spacer"></td>
 			</tr>
		<% end %>
	<% end %>
</table>

<%#="home.erb time: " + (Time.new-start_time).to_s %>